Sub updateWarshipList()
    Dim LRng as Range, RRng as Range, Rng as Range, team as Range, cell as Range, lookUp as Range
    Dim i as Integer
    Dim addr as String
    With Sheet1
    Set LRng = .Range("D2:D" & LWarshipNum)
    Set RRng = .Range("G2:G" & UWarshipNum + 1)
    Set Rng = .Range("D2:D" & LWarshipNum & ", G2:G" & UWarshipNum + 1)
    Rng.ClearContents
    Rng.Offset(0, 1).Value = False
    
    i = teamMember + 1
    If .Range("B1").Value = vbNullString Then
        For Each cell in Rng
            cell.value = i - 5
            .OLEObjects("CheckBox" & i).Object.Caption = getWarshipName(i - 5)
            .OLEObjects("CheckBox" & i).Visible = True
            i = i + 1
        Next cell
    ElseIf .Range("B1").Value = "-" Then
        For Each cell in LRng
            cell.value = i - 5
            .OLEObjects("CheckBox" & i).Object.Caption = getWarshipName(i - 5)
            .OLEObjects("CheckBox" & i).Visible = True
            i = i + 1
        Next Cell

        For Each cell in RRng
            .OLEObjects("CheckBox" & i).Object.Caption = vbNullString
            .OLEObjects("CheckBox" & i).Visible = False
            i = i + 1 
        Next cell
    ElseIf .Range("B1").Value = "+" Then
        For Each cell in LRng
            .OLEObjects("CheckBox" & i).Object.Caption = vbNullString
            .OLEObjects("CheckBox" & i).Visible = False
            i = i + 1
        Next Cell

        For Each cell in RRng
            cell.value = i - 5
            .OLEObjects("CheckBox" & i).Object.Caption = getWarshipName(i - 5)
            .OLEObjects("CheckBox" & i).Visible = True
            i = i + 1 
        Next cell
    Else
        With Sheet2.Range("H2:H" & warshipNum)
        Set lookUp = .find(Range("B1").Value, LookIn:= xlValues, LookAt:= xlPart)
        If Not lookUp Is Nothing Then
            addr = lookUp.Address
            Do
                LRng(i - teamMember).Value = lookUp.Row
                With Sheet1
                .OLEObjects("CheckBox" & i).Object.Caption = lookUp.Offset(0, -6).Value
                .OLEObjects("CheckBox" & i).Visible = True
                End With
                i = i + 1
                Set lookUp = .FindNext(lookUp)
                If lookUp Is Nothing Then GoTo done
            Loop While Not lookUp Is Nothing And lookUp.Address <> addr
        End If
        End With
done:
        Do While i < teamMember + warshipNum
            .OLEObjects("CheckBox" & i).Object.Caption = vbNullString
            .OLEObjects("CheckBox" & i).Visible = False    
            i = i + 1
        Loop
    End If
    
    Set team = .Range("K2:K7")
    For Each cell in team
        If cell.Value <> 0 Then
            Set lookUp = Rng.find(cell.Value, LookIn:=xlValues, LookAt:=xlWhole)
            If Not lookUp Is Nothing Then lookUp.Offset(0, 1).Value = True
        End If
    Next cell
    End With
End Sub

Function editFromList(ByVal r As Integer, chk As Boolean) As Boolean
    Dim team As Range, cell As Range, lookUp As Range
    Dim i As Integer
    editFromList = False
    With Sheet1
    Set team = .Range("K2:K7")
    If chk Then
        For Each cell In team
            If cell.Value = vbNullString Then
                i = cell.Row - 1
                cell.Value = r
                cell.Offset(0, 1).Value = True
                .OLEObjects("CheckBox" & i).Object.Caption = getWarshipName(r)
                .OLEObjects("CheckBox" & i).Visible = True
                editFromList = True
                Exit Function
            End If
        Next cell
        MsgBox "have been selected 6 warships"
    Else
        For Each cell In team
            Set lookUp = team.find(r, LookIn:=xlValues, LookAt:=xlWhole)
            If Not lookUp Is Nothing Then
                i = lookUp.Row - 1
                lookUp.ClearContents
                lookUp.Offset(0, 1).Value = False
                .OLEObjects("CheckBox" & i).Object.Caption = vbNullString
                .OLEObjects("CheckBox" & i).Visible = False
                Exit Function
            End If
        Next cell
    End If
    End With
End Function

Sub editFromTeam(ByVal r As Integer)
    Dim Rng As Range, cell As Range
    Dim i As Integer
    Dim result as Boolean
    result = editFromList(r, False)
    Set cell = Sheet1.Range("D2:D" & LWarshipNum & ", G2:G" & UWarshipNum + 1).find(r, LookIn:=xlValues, LookAt:=xlWhole)
    If Not cell Is Nothing Then cell.Offset(0, 1).Value = result
End Sub

